<mxfile host="drawio-plugin" modified="2022-11-29T09:09:01.434Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36" etag="ZYxi2lZTpWRVBdfjCeac" version="20.5.3" type="embed"><diagram id="HIiCCss5zzO2NKNbIPJ_" name="Page-1"><mxGraphModel dx="842" dy="700" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#1ba1e2;strokeColor=#006EAF;strokeWidth=2;" parent="1" source="2" target="3" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="2" value="&lt;font style=&quot;font-size: 14px&quot;&gt;客户端传递 ID&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="60" y="20" width="80" height="40" as="geometry"/></mxCell><mxCell id="6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=2;" parent="1" source="3" target="5" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="10" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=2;" parent="1" source="3" target="9" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="3" value="&lt;font style=&quot;font-size: 15px&quot;&gt;布隆过滤器&lt;/font&gt;" style="rhombus;whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1"><mxGeometry x="60" y="90" width="80" height="80" as="geometry"/></mxCell><mxCell id="5" value="&lt;font style=&quot;font-size: 20px&quot;&gt;不存在直接返回nil&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1"><mxGeometry x="40" y="220" width="120" height="60" as="geometry"/></mxCell><mxCell id="14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=2;" parent="1" source="9" target="13" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fillColor=#a20025;strokeColor=#6F0000;" parent="1" source="9" target="15" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="9" value="&lt;font style=&quot;font-size: 15px&quot;&gt;&lt;span&gt;从redis中读取缓存&lt;/span&gt;&lt;/font&gt;" style="rhombus;whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1"><mxGeometry x="220" y="90" width="80" height="80" as="geometry"/></mxCell><mxCell id="13" value="&lt;font style=&quot;font-size: 20px&quot;&gt;存在返回缓存&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1"><mxGeometry x="390" y="100" width="120" height="60" as="geometry"/></mxCell><mxCell id="18" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=2;" parent="1" source="15" target="17" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="20" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=2;" parent="1" source="15" target="19" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="15" value="&lt;span&gt;不存在，加redis锁，重建缓存&lt;/span&gt;" style="rhombus;whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1"><mxGeometry x="220" y="220" width="80" height="80" as="geometry"/></mxCell><mxCell id="25" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fillColor=#1ba1e2;strokeColor=#006EAF;strokeWidth=2;" parent="1" source="17" target="24" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="17" value="&lt;font style=&quot;font-size: 20px&quot;&gt;拿到锁&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1"><mxGeometry x="200" y="340" width="120" height="60" as="geometry"/></mxCell><mxCell id="19" value="&lt;font style=&quot;font-size: 20px&quot;&gt;没有拿到锁&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1"><mxGeometry x="390" y="230" width="120" height="60" as="geometry"/></mxCell><mxCell id="22" value="" style="endArrow=classic;html=1;rounded=0;exitX=-0.017;exitY=0.892;exitDx=0;exitDy=0;exitPerimeter=0;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=2;" parent="1" source="19" edge="1"><mxGeometry width="50" height="50" relative="1" as="geometry"><mxPoint x="370" y="360" as="sourcePoint"/><mxPoint x="280" y="284" as="targetPoint"/></mxGeometry></mxCell><mxCell id="23" value="&lt;font style=&quot;font-size: 14px&quot;&gt;自旋重新去获取锁&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1"><mxGeometry x="270" y="285" width="140" height="30" as="geometry"/></mxCell><mxCell id="27" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FFFFFF;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=2;" parent="1" source="24" target="26" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="29" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FFFFFF;fillColor=#a20025;strokeColor=#6F0000;strokeWidth=2;" parent="1" source="24" target="28" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="24" value="&lt;pre style=&quot;background-color: rgb(40 , 44 , 52) ; font-family: &amp;#34;jetbrains mono&amp;#34; , monospace ; font-size: 10.5pt&quot;&gt;&lt;font color=&quot;#ffffff&quot;&gt;&lt;span style=&quot;font-style: italic&quot;&gt;DCL&lt;/span&gt;&lt;span style=&quot;font-style: italic ; font-family: , monospace&quot;&gt;双重检查缓存&lt;/span&gt;&lt;/font&gt;&lt;/pre&gt;" style="rhombus;whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1"><mxGeometry x="220" y="450" width="80" height="80" as="geometry"/></mxCell><mxCell id="26" value="&lt;font style=&quot;font-size: 14px&quot;&gt;有缓存，&lt;br&gt;返回缓存值，&lt;br&gt;释放锁&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1"><mxGeometry x="200" y="570" width="120" height="60" as="geometry"/></mxCell><mxCell id="31" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FFFFFF;fillColor=#1ba1e2;strokeColor=#006EAF;strokeWidth=2;" parent="1" source="28" target="30" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="33" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;" edge="1" parent="1" source="28" target="24"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="28" value="没有缓存，查询数据库并把数据库信息缓存到redis中" style="whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1"><mxGeometry x="360" y="460" width="120" height="60" as="geometry"/></mxCell><mxCell id="30" value="&lt;font style=&quot;font-size: 20px&quot;&gt;返回数据；释放锁&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=0;" parent="1" vertex="1"><mxGeometry x="560" y="460" width="120" height="60" as="geometry"/></mxCell></root></mxGraphModel></diagram></mxfile>